{"version":3,"sources":["../../../src/modules/degewo/DegewoFlatOfferDetailPage.js"],"names":["DegewoFlatOfferDetailPage","FlatOfferDetailPage","getObjectDetails","objectDetails","objectDetailsElement","page","$","objectDetailsTitleElement","objectDetailsTitle","evaluate","node","innerText","Error","objectDetailsRows","$$","Promise","all","map","objectDetailsRow","key","children","innerHTML","value","getObjectDetail","keyToFind","find","getColdServiceCharges","getWarmServiceCharges","getArea","areaX","getNumberOfRooms","numberOfRoomsX","getSeniorsOnly","descriptionFirstParagraphElement","descriptionFirstParagraphText","test"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AACA;;AAEO,MAAMA,yBAAN,SAAwCC,wCAAxC,CAA4D;AACjE,QAAMC,gBAAN,GAA0B;AACxB,QAAI,CAAC,KAAKC,aAAV,EAAyB;AACvB,YAAMC,oBAAoB,GAAG,MAAM,KAAKC,IAAL,CAAUC,CAAV,CAAY,oEAAZ,CAAnC;AACA,YAAMC,yBAAyB,GAAG,MAAMH,oBAAoB,CAACE,CAArB,CAAuB,wBAAvB,CAAxC;AACA,YAAME,kBAAkB,GAAG,MAAMD,yBAAyB,CAACE,QAA1B,CAAmCC,IAAI,IAAIA,IAAI,CAACC,SAAhD,CAAjC;;AACA,UAAIH,kBAAkB,KAAK,eAA3B,EAA4C;AAC1C,cAAM,IAAII,KAAJ,CAAU,uCAAV,CAAN;AACD;;AACD,YAAMC,iBAAiB,GAAG,MAAMT,oBAAoB,CAACU,EAArB,CAAwB,4BAAxB,CAAhC;AACA,WAAKX,aAAL,GAAqB,MAAMY,OAAO,CAACC,GAAR,CAAYH,iBAAiB,CAACI,GAAlB,CAAsB,MAAMC,gBAAN,IAA0B;AACrF,cAAMC,GAAG,GAAG,MAAMD,gBAAgB,CAACT,QAAjB,CAA0BC,IAAI,IAAIA,IAAI,CAACU,QAAL,CAAc,CAAd,EAAiBC,SAAnD,CAAlB;AACA,cAAMC,KAAK,GAAG,MAAMJ,gBAAgB,CAACT,QAAjB,CAA0BC,IAAI,IAAIA,IAAI,CAACU,QAAL,CAAc,CAAd,EAAiBC,SAAnD,CAApB;AACA,eAAO,CAACF,GAAD,EAAMG,KAAN,CAAP;AACD,OAJsC,CAAZ,CAA3B;AAKD;;AAED,WAAO,KAAKnB,aAAZ;AACD;;AAED,QAAMoB,eAAN,CAAuBC,SAAvB,EAAkC;AAChC,WAAO,CAAC,MAAM,KAAKtB,gBAAL,EAAP,EAAgCuB,IAAhC,CAAqC,CAAC,CAACN,GAAD,CAAD,KAAWA,GAAG,KAAKK,SAAxD,CAAP;AACD;;AAED,QAAME,qBAAN,GAA+B;AAC7B,WAAO,MAAM,oIACX,KAAKrB,IADM,EAEX,+CACA,4EAHW,EAIX,uBAJW,EAKX,sCALW,CAAb;AAOD;;AAED,QAAMsB,qBAAN,GAA+B;AAC7B,WAAO,MAAM,oIACX,KAAKtB,IADM,EAEX,+CACA,4EAHW,EAIX,uBAJW,EAKX,sCALW,CAAb;AAOD;;AAED,QAAMuB,OAAN,GAAiB;AACf,UAAMC,KAAK,GAAG,MAAM,KAAKN,eAAL,CAAqB,YAArB,CAApB;;AACA,QAAI,CAACM,KAAL,EAAY;AACV,YAAM,IAAIjB,KAAJ,CAAU,sBAAV,CAAN;AACD;;AACD,WAAO,0CAAkBiB,KAAK,CAAC,CAAD,CAAvB,CAAP;AACD;;AAED,QAAMC,gBAAN,GAA0B;AACxB,UAAMC,cAAc,GAAG,MAAM,KAAKR,eAAL,CAAqB,QAArB,CAA7B;;AACA,QAAI,CAACQ,cAAL,EAAqB;AACnB,YAAM,IAAInB,KAAJ,CAAU,iCAAV,CAAN;AACD;;AACD,WAAO,4CAAmBmB,cAAc,CAAC,CAAD,CAAjC,CAAP;AACD;;AAED,QAAMC,cAAN,GAAwB;AACtB,UAAMC,gCAAgC,GAAG,MAAM,KAAK5B,IAAL,CAAUC,CAAV,CAC7C,qGAD6C,CAA/C;AAGA,UAAM4B,6BAA6B,GAAG,MAAMD,gCAAgC,CAACxB,QAAjC,CAA0CC,IAAI,IAAIA,IAAI,CAACC,SAAvD,CAA5C;AACA,WAAO,4BAA4BwB,IAA5B,CAAiCD,6BAAjC,CAAP;AACD;;AAlEgE","sourcesContent":["import { FlatOfferDetailPage } from '../../lib/FlatOfferDetailPage.js'\nimport { getInnerTextAndExtractCurrencyValueFromLabeledTextOrThrowError } from '../../lib/getInnerTextAndExtractCurrencyValueFromLabeledTextOrThrowError.js'\nimport { parseCurrencyText } from '../../lib/parseCurrencyText.js'\nimport { parseNumberOfRooms } from '../../lib/parseNumberOfRooms.js'\n\nexport class DegewoFlatOfferDetailPage extends FlatOfferDetailPage {\n  async getObjectDetails () {\n    if (!this.objectDetails) {\n      const objectDetailsElement = await this.page.$('#c1358 > :nth-child(2) > :nth-child(1) > div.teaser-tileset__col-1')\n      const objectDetailsTitleElement = await objectDetailsElement.$('.teaser-tileset__title')\n      const objectDetailsTitle = await objectDetailsTitleElement.evaluate(node => node.innerText)\n      if (objectDetailsTitle !== 'Objektdetails') {\n        throw new Error(\"Couldn't find object details element.\")\n      }\n      const objectDetailsRows = await objectDetailsElement.$$('.teaser-tileset__table-row')\n      this.objectDetails = await Promise.all(objectDetailsRows.map(async objectDetailsRow => {\n        const key = await objectDetailsRow.evaluate(node => node.children[0].innerHTML)\n        const value = await objectDetailsRow.evaluate(node => node.children[1].innerHTML)\n        return [key, value]\n      }))\n    }\n\n    return this.objectDetails\n  }\n\n  async getObjectDetail (keyToFind) {\n    return (await this.getObjectDetails()).find(([key]) => key === keyToFind)\n  }\n\n  async getColdServiceCharges () {\n    return await getInnerTextAndExtractCurrencyValueFromLabeledTextOrThrowError(\n      this.page,\n      '.article .ce-table.expose__header-details ' +\n      '> .ce-table__row > .ce-table__row-item:nth-child(2) > ul > li:nth-child(1)',\n      'Betriebskosten (kalt)',\n      'Couldn\\'t find cold service charges.'\n    )\n  }\n\n  async getWarmServiceCharges () {\n    return await getInnerTextAndExtractCurrencyValueFromLabeledTextOrThrowError(\n      this.page,\n      '.article .ce-table.expose__header-details ' +\n      '> .ce-table__row > .ce-table__row-item:nth-child(2) > ul > li:nth-child(2)',\n      'Betriebskosten (warm)',\n      'Couldn\\'t find warm service charges.'\n    )\n  }\n\n  async getArea () {\n    const areaX = await this.getObjectDetail('Wohnfläche')\n    if (!areaX) {\n      throw new Error('Couldn\\'t find area.')\n    }\n    return parseCurrencyText(areaX[1])\n  }\n\n  async getNumberOfRooms () {\n    const numberOfRoomsX = await this.getObjectDetail('Zimmer')\n    if (!numberOfRoomsX) {\n      throw new Error('Couldn\\'t find number of rooms.')\n    }\n    return parseNumberOfRooms(numberOfRoomsX[1])\n  }\n\n  async getSeniorsOnly () {\n    const descriptionFirstParagraphElement = await this.page.$(\n      '#c1358 > div:nth-child(2) > section:nth-child(2) > div.teaser-tileset__col-1 > section > header > p'\n    )\n    const descriptionFirstParagraphText = await descriptionFirstParagraphElement.evaluate(node => node.innerText)\n    return /für ältere(?:n)? Menschen/.test(descriptionFirstParagraphText)\n  }\n}\n"],"file":"DegewoFlatOfferDetailPage.js"}