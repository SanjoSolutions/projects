{"version":3,"sources":["../../src/modules/fetch_one_test.js"],"names":["process","env","NODE_ENV","run","main","moduleNameUnderTest","argv","modulePathUnderTest","path","resolve","__dirname","fetchOnce","browser","puppeteer","launch","headless","defaultViewport","width","height","getBrowser","page","newPage","url","flatOffer","onFlatOffer","_flatOffer","console","log","shouldStop","Boolean","fn","then","error"],"mappings":";;AAEA;;AACA;;;;;;AAHAA,OAAO,CAACC,GAAR,CAAYC,QAAZ,GAAuB,SAAvB;;;AAKAC,GAAG,CAACC,IAAD,CAAH;;AAEA,eAAeA,IAAf,GAAuB;AACrB,QAAMC,mBAAmB,GAAGL,OAAO,CAACM,IAAR,CAAa,CAAb,CAA5B;AACA,QAAMC,mBAAmB,GAAGC,IAAI,CAACC,OAAL,CAAaC,SAAb,EAAwBL,mBAAxB,EAA6C,UAA7C,CAA5B;AACA,QAAM;AAAEM,IAAAA;AAAF,MAAgB,yBAAaJ,mBAAb,kDAAtB;AAEA,QAAMK,OAAO,GAAG,MAAMC,SAAS,CAACC,MAAV,CAAiB;AACrCC,IAAAA,QAAQ,EAAE,KAD2B;AAErCC,IAAAA,eAAe,EAAE;AACfC,MAAAA,KAAK,EAAE,IADQ;AAEfC,MAAAA,MAAM,EAAE;AAFO;AAFoB,GAAjB,CAAtB;;AAQA,WAASC,UAAT,GAAuB;AACrB,WAAOP,OAAP;AACD;;AAED,QAAMQ,IAAI,GAAG,MAAMR,OAAO,CAACS,OAAR,EAAnB;AAEA,QAAMC,GAAG,GAAGtB,OAAO,CAACM,IAAR,CAAa,CAAb,CAAZ;AACA,MAAIiB,SAAJ;;AAEA,iBAAeC,WAAf,CAA4BC,UAA5B,EAAwC;AACtC,QAAIA,UAAU,CAACH,GAAX,KAAmBA,GAAvB,EAA4B;AAC1BC,MAAAA,SAAS,GAAGE,UAAZ;AACAC,MAAAA,OAAO,CAACC,GAAR,CAAY,cAAZ,EAA4BF,UAA5B;AACD;AACF;;AAED,WAASG,UAAT,GAAuB;AACrB,WAAOC,OAAO,CAACN,SAAD,CAAd;AACD;;AAED,QAAMZ,SAAS,CAACQ,UAAD,EAAaC,IAAb,EAAmBI,WAAnB,EAAgCI,UAAhC,CAAf;AACD;;AAED,SAASzB,GAAT,CAAc2B,EAAd,EAAkB;AAChBA,EAAAA,EAAE,GAAGC,IAAL,CAAUL,OAAO,CAACC,GAAlB,EAAuBD,OAAO,CAACM,KAA/B;AACD","sourcesContent":["process.env.NODE_ENV = 'TESTING'\n\nimport path from 'path'\nimport puppeteer from 'puppeteer'\n\nrun(main)\n\nasync function main () {\n  const moduleNameUnderTest = process.argv[2]\n  const modulePathUnderTest = path.resolve(__dirname, moduleNameUnderTest, 'index.js')\n  const { fetchOnce } = await import(modulePathUnderTest)\n\n  const browser = await puppeteer.launch({\n    headless: false,\n    defaultViewport: {\n      width: 1024,\n      height: 768\n    }\n  })\n\n  function getBrowser () {\n    return browser\n  }\n\n  const page = await browser.newPage()\n\n  const url = process.argv[3]\n  let flatOffer\n\n  async function onFlatOffer (_flatOffer) {\n    if (_flatOffer.url === url) {\n      flatOffer = _flatOffer\n      console.log('Flat offer: ', _flatOffer)\n    }\n  }\n\n  function shouldStop () {\n    return Boolean(flatOffer)\n  }\n\n  await fetchOnce(getBrowser, page, onFlatOffer, shouldStop)\n}\n\nfunction run (fn) {\n  fn().then(console.log, console.error)\n}\n"],"file":"fetch_one_test.js"}