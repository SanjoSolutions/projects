{"version":3,"sources":["../../src/modules/apply_test.js"],"names":["process","env","NODE_ENV","run","main","moduleNameUnderTest","argv","modulePathUnderTest","path","resolve","__dirname","fetchOnce","browser","puppeteer","launch","headless","defaultViewport","width","height","getBrowser","page","newPage","flatOffer","onFlatOffer","_flatOffer","console","log","shouldStop","Boolean","apply","contactData","fn","then","error"],"mappings":";;AAEA;;AACA;;AACA;;;;;;AAJAA,OAAO,CAACC,GAAR,CAAYC,QAAZ,GAAuB,SAAvB;;;AAMAC,GAAG,CAACC,IAAD,CAAH;;AAEA,eAAeA,IAAf,GAAuB;AACrB,QAAMC,mBAAmB,GAAGL,OAAO,CAACM,IAAR,CAAa,CAAb,CAA5B;AACA,QAAMC,mBAAmB,GAAGC,IAAI,CAACC,OAAL,CAAaC,SAAb,EAAwBL,mBAAxB,EAA6C,UAA7C,CAA5B;AACA,QAAM;AAAEM,IAAAA;AAAF,MAAgB,yBAAaJ,mBAAb,kDAAtB;AAEA,QAAMK,OAAO,GAAG,MAAMC,SAAS,CAACC,MAAV,CAAiB;AACrCC,IAAAA,QAAQ,EAAE,KAD2B;AAErCC,IAAAA,eAAe,EAAE;AACfC,MAAAA,KAAK,EAAE,IADQ;AAEfC,MAAAA,MAAM,EAAE;AAFO;AAFoB,GAAjB,CAAtB;;AAQA,WAASC,UAAT,GAAsB;AACpB,WAAOP,OAAP;AACD;;AAED,QAAMQ,IAAI,GAAG,MAAMR,OAAO,CAACS,OAAR,EAAnB;AAEA,MAAIC,SAAS,GAAG,IAAhB;;AAEA,iBAAeC,WAAf,CAA4BC,UAA5B,EAAwC;AACtC,QAAI,CAACF,SAAL,EAAgB;AACdG,MAAAA,OAAO,CAACC,GAAR,CAAY,cAAZ,EAA4BF,UAA5B;AACAF,MAAAA,SAAS,GAAGE,UAAZ;AACD;AACF;;AAED,WAASG,UAAT,GAAuB;AACrB,WAAOC,OAAO,CAACN,SAAD,CAAd;AACD;;AAED,QAAMX,SAAS,CAACQ,UAAD,EAAaC,IAAb,EAAmBG,WAAnB,EAAgCI,UAAhC,CAAf;;AAEA,MAAIL,SAAJ,EAAe;AACbA,IAAAA,SAAS,CAACO,KAAV,CAAgBV,UAAhB,EAA4BW,mBAA5B;AACD;AACF;;AAED,SAAS3B,GAAT,CAAc4B,EAAd,EAAkB;AAChBA,EAAAA,EAAE,GAAGC,IAAL,CAAUP,OAAO,CAACC,GAAlB,EAAuBD,OAAO,CAACQ,KAA/B;AACD","sourcesContent":["process.env.NODE_ENV = 'TESTING'\n\nimport path from 'path'\nimport puppeteer from 'puppeteer'\nimport { contactData } from '../config.js'\n\nrun(main)\n\nasync function main () {\n  const moduleNameUnderTest = process.argv[2]\n  const modulePathUnderTest = path.resolve(__dirname, moduleNameUnderTest, 'index.js')\n  const { fetchOnce } = await import(modulePathUnderTest)\n\n  const browser = await puppeteer.launch({\n    headless: false,\n    defaultViewport: {\n      width: 1024,\n      height: 768\n    }\n  })\n\n  function getBrowser() {\n    return browser\n  }\n\n  const page = await browser.newPage()\n\n  let flatOffer = null\n\n  async function onFlatOffer (_flatOffer) {\n    if (!flatOffer) {\n      console.log('Flat offer: ', _flatOffer)\n      flatOffer = _flatOffer\n    }\n  }\n\n  function shouldStop () {\n    return Boolean(flatOffer)\n  }\n\n  await fetchOnce(getBrowser, page, onFlatOffer, shouldStop)\n\n  if (flatOffer) {\n    flatOffer.apply(getBrowser, contactData)\n  }\n}\n\nfunction run (fn) {\n  fn().then(console.log, console.error)\n}\n"],"file":"apply_test.js"}